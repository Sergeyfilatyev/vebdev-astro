---
import Button from '../ui/Button.astro';

const {
	variant = 'default',
	headline,
	subheadline,
	primaryCTA,
	secondaryCTA,
	backgroundVideo,
	backgroundImage,
	title,
	subtitle,
	paragraph,
	buttonText,
	buttonLink,
	variantBackgroundImage,
} = Astro.props;

const locale = Astro.props.locale || 'uk';

const getLocalizedLink = (link: string, currentLocale: string): string => {
	const defaultLang = 'uk';
	if (link === '/') {
		if (currentLocale !== defaultLang) {
			return `/${currentLocale}`;
		}
		return '/';
	}
	if (link.startsWith('/') || link.includes('://')) {
		return link;
	}
	if (currentLocale === defaultLang) {
		return `/${link}`;
	} else {
		return `/${currentLocale}/${link}`;
	}
};
---

{variant === 'default' ? (
	<section class='relative min-h-screen flex items-center justify-center overflow-hidden'>
		{backgroundVideo ? (
			<video
				autoplay
				loop
				muted
				playsinline
				class='absolute inset-0 w-full h-full object-cover z-0 scale-110'
				style='filter: brightness(0.3);'
			>
				<source src={backgroundVideo.url || backgroundVideo} type='video/mp4' />
			</video>
		) : backgroundImage ? (
			<div class='absolute inset-0 z-0'>
				<img
					src={typeof backgroundImage === 'string' ? backgroundImage : backgroundImage.url}
					alt='Hero background'
					class='w-full h-full object-cover scale-110'
					style='filter: brightness(0.3) blur(2px);'
				/>
			</div>
		) : (
			<div class='absolute inset-0 bg-gradient-to-br from-primary-900 via-primary-800 to-primary-900 z-0'></div>
		)}

		<div class='absolute inset-0 bg-gradient-to-b from-primary-900/80 via-primary-900/60 to-primary-900/80 z-10'></div>

		<div class='absolute inset-0 z-10'>
			<div class='absolute top-1/4 left-1/4 w-96 h-96 bg-primary-500/10 rounded-full blur-3xl animate-pulse'></div>
			<div class='absolute bottom-1/4 right-1/4 w-96 h-96 bg-primary-200/10 rounded-full blur-3xl animate-pulse' style='animation-delay: 1s;'></div>
		</div>

		<div class='relative z-20 container text-center px-4 py-20'>
			{headline && (
				<h1 class='text-5xl md:text-7xl lg:text-8xl font-bold mb-8 fade-in-up'>
					<span class='gradient-text'>{headline}</span>
				</h1>
			)}
			{subheadline && (
				<p class='text-xl md:text-2xl lg:text-3xl text-primary-100 mb-12 max-w-4xl mx-auto leading-relaxed fade-in-up fade-in-delay-1'>
					{subheadline}
				</p>
			)}
			<div class='flex flex-col sm:flex-row gap-6 justify-center items-center fade-in-up fade-in-delay-2'>
				{primaryCTA?.text && primaryCTA?.url && (
					<Button
						variant='primary'
						size='lg'
						isLink
						href={getLocalizedLink(primaryCTA.url, locale)}
						class='min-w-[240px] glow-effect text-lg px-8 py-4'>
						{primaryCTA.text}
					</Button>
				)}
				{secondaryCTA?.text && secondaryCTA?.url && (
					<Button
						variant='outline'
						size='lg'
						isLink
						href={getLocalizedLink(secondaryCTA.url, locale)}
						class='min-w-[240px] text-lg px-8 py-4 border-2'>
						{secondaryCTA.text}
					</Button>
				)}
			</div>
		</div>
	</section>
) : (
	<section class='relative py-24 md:py-32 overflow-hidden'>
		<div class='absolute inset-0 bg-gradient-to-br from-primary-900/50 to-transparent'></div>
		<div class='container px-4 relative z-10'>
			<div
				class={`
        grid md:grid-cols-2 gap-12 items-center
        ${variant === 'left' ? '' : variant === 'right' ? 'md:grid-flow-dense' : 'md:grid-cols-1 text-center'}
      `}>
				{variantBackgroundImage && (
					<div
						class={`
            ${variant === 'right' ? 'md:col-start-2' : ''}
            ${variant === 'center' ? 'max-w-2xl mx-auto' : ''}
            fade-in-up
          `}>
						<div class='relative group'>
							<div class='absolute -inset-4 bg-gradient-to-r from-primary-500/20 to-primary-200/20 rounded-3xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500'></div>
							<img
								src={typeof variantBackgroundImage === 'string' ? variantBackgroundImage : variantBackgroundImage.url}
								alt={title || 'Hero image'}
								class='relative w-full h-auto rounded-2xl shadow-2xl transform group-hover:scale-105 transition-transform duration-500'
							/>
						</div>
					</div>
				)}

				<div
					class={`
          ${variant === 'right' ? 'md:col-start-1 md:row-start-1' : ''}
          ${variant === 'center' ? 'max-w-3xl mx-auto' : ''}
          fade-in-up fade-in-delay-1
        `}>
					{title && (
						<h1 class='text-4xl md:text-5xl lg:text-6xl font-bold mb-6'>
							<span class='gradient-text'>{title}</span>
						</h1>
					)}
					{subtitle && (
						<h2 class='text-2xl md:text-3xl text-primary-200 mb-6 font-semibold'>{subtitle}</h2>
					)}
					{paragraph && (
						<p class='text-lg md:text-xl text-primary-100 mb-8 leading-relaxed'>{paragraph}</p>
					)}
					{buttonText && buttonLink && (
						<Button variant='primary' size='lg' isLink href={getLocalizedLink(buttonLink, locale)} class='glow-effect'>
							{buttonText}
						</Button>
					)}
				</div>
			</div>
		</div>
	</section>
)}
